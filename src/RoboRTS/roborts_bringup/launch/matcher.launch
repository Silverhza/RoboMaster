<!--
Example launch file: launches the scan matcher with pre-recorded data
-->

<launch>
    <arg name="node_namespace" value="$(optenv CAR_ID)"/>
    <arg name="amcl_map"                  default="lidar_scan"/>

    <node pkg="tf2_ros" type="static_transform_publisher" name="gimbal_front_laser_link_broadcaster" ns="$(arg node_namespace)"
          args="0.10 0.0 0.1 0.0 0.0 3.14 $(arg node_namespace)/gimbal_fixed $(arg node_namespace)/front_laser_link" />

    <node name="amcl_map_server" pkg="map_server" type="map_server" args="$(find roborts_bringup)/maps/$(arg amcl_map).yaml" respawn="false">
    <remap from="/static_map"          to="/amcl_static_map"/>
    <remap from="/map"                 to="/amcl_map"/>
    </node>



  <node name="urg_node" pkg="urg_node" type="urg_node" output="screen">
    <param name="ip_address" value="192.168.0.10"/>
    <param name="serial_port" value="/dev/ttyACM0"/>
    <param name="serial_baud" value="115200"/>
    <param name="frame_id" value="/$(optenv CAR_ID)/front_laser_link"/>
    <param name="calibrate_time" value="true"/>
    <param name="publish_intensity" value="false"/>
    <param name="publish_multiecho" value="false"/>
    <param name="angle_min" value="-1.5707963"/>
    <param name="angle_max" value="1.5707963"/>
    <remap from="/scan" to="/$(optenv CAR_ID)/scan"/>
  </node>

  #### start the laser scan_matcher ##############################

    <node pkg="laser_scan_matcher" type="laser_scan_matcher_node"
    name="laser_scan_matcher_node" output="screen">
    <remap from="/scan" to="/$(optenv CAR_ID)/scan"/>
    <remap from="/odom" to="/$(optenv CAR_ID)/odom_normal"/>
    <param name="base_frame" value="/$(optenv CAR_ID)/gimbal_fixed"/>
    <param name="max_iterations" value="10"/>
    <param name="publish_tf" value="true"/>
    <param name="fixed_frame" value="map"/>
    <param name="use_imu" value="false"/>
    <param name="use_odom" value="false"/>
    <param name="publish_pose_stamped" value="true"/>

  </node>



</launch>
